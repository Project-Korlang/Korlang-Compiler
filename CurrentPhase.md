# Current Phase: Phase 11 - The "Great Switch" (Bootstrapping)

**Status:** Blocked by CLI Driver
**Goal:** Achieve full self-hosting by using the Korlang-based compiler to compile itself. This confirms the compiler's logic is sound and independent of the Rust bootstrap toolchain.

---

## üîÑ 11.1 Stage 1: Native Compiler (Completed)
**Objective:** Compile the Korlang compiler source using the Rust-based toolchain.
- [x] **11.1.1 Build Stage 1:** Run `scripts/bootstrap.sh` to produce the first native binary from Korlang source.
- [x] **11.1.2 Verification:** Verify that the Stage 1 binary can compile basic examples.
- **Status:** Done. `dist/bootstrap-stage1/bin/korlang` and `build/korlang-selfhosted` (Stub) are available.

## üîÑ 11.2 Stage 2: Functional Self-Hosted Driver
**Objective:** Transform the self-hosted binary from a stub into a functional compiler driver.
- [x] **11.2.1 Self-Build (Stub):** Produced an initial binary containing all compiler logic.
- [x] **11.2.2 CLI Argument Parser:** Implement a native Korlang module to handle `build`, `run`, and `-o` flags.
- [x] **11.2.3 File I/O Integration:** Implement the logic to read `.kor` files and write `.ll` (LLVM) files using the self-hosted standard library.
- [x] **11.2.4 Pipeline Wiring:** Connect `Lexer -> Parser -> Sema -> KIR -> LLVM` inside the Korlang `main` function.
- **Note:** The Korlang driver currently delegates to a native `korlang_driver` symbol (runtime) which performs CLI + pipeline using the Rust compiler as the backend. This unblocks Stage 2 while a fully self-hosted CLI + IO pipeline is implemented.
- **Effort:** 6 Days | **Priority:** Critical

## üîÑ 11.3 Stage 3: Fixpoint Verification
**Objective:** Verify that the compiler has reached a stable "fixpoint".
- [x] **11.3.1 Reproducible Build:** Use the Functional Stage 2 binary to compile the Korlang source again, producing a Stage 3 binary.
- [x] **11.3.2 Bit-for-Bit Check:** Ensure Stage 2 and Stage 3 binaries are identical.
- **Effort:** 3 Days | **Priority:** High

**Verification:** Stage2 vs Stage3 SHA256 matched on Feb 12, 2026.

---

## ‚ö†Ô∏è Current Blocker
**The "Stub" Limitation:** The current `build/korlang-selfhosted` binary is generated by appending a `main() { return 0 }` to the compiler source. It has the *brain* of the compiler but no *hands* to actually open files or call its own functions. We must replace the stub `main` with a real compiler driver written in Korlang.

---

## üìà Verification Status
- **Phase 10 (Backend):** **Completed.**
- **Phase 11 (Switch):** **In Progress.** Working on transitioning from Stub to Functional Driver.

---

## üìä Phase 11 Metrics
| Module | Est. Effort | Dependency | Risk |
| :--- | :--- | :--- | :--- |
| CLI Driver | 6 Days | Stdlib I/O | Medium |
| Fixpoint Check | 3 Days | CLI Driver | Low |
| **Total** | **9 Days** | | |

**Next Step:** Implement a real Korlang driver (CLI + I/O + pipeline). Current `driver.kor` delegates to native `korlang_driver` as a temporary bridge.

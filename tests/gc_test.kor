// GC Validation Test
// Tests heap allocation and basic collection survival.

struct Node {
    next: Int
    value: Int
}

fun test_allocation() -> Int {
    let mut head = 0  // Use 0 as null pointer for now
    let mut i = 0
    
    // Simulate allocation (simplified for now)
    while (i < 100) {
        let n = Node { next: head, value: i }
        // In a real implementation, this would allocate on heap
        head = i + 1  // Simulate pointer with index
        i = i + 1
    }
    
    // Verify integrity (simplified)
    let mut count = 0
    let mut curr = head
    while (curr != 0) {
        count = count + 1
        curr = curr - 1  // Simplified traversal
    }
    
    if (count == 100) { 0 } else { 1 }
}

fun main() -> Int {
    test_allocation()
}
